// prisma/schema.prisma
datasource db {
  provider = "postgresql"
  // On ne met plus de "url" ici !
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            String   @id @default(cuid())
  name          String
  email         String   @unique
  walletBalance Int      @default(1000) // Crédits de départ
  bets          Bet[]
  createdAt     DateTime @default(now())
}

model Course {
  id                String      @id @default(cuid())
  subject           String      // Matière (ex: Économétrie)
  professor         String      // Nom du prof
  scheduledStartTime DateTime    // Heure de début officielle
  actualArrivalTime  DateTime?   // Heure d'arrivée réelle d'Hugo
  status            CourseStatus @default(OPEN)
  bets              Bet[]
  totalPot          Int         @default(0)
}

enum CourseStatus {
  OPEN      // Pari ouvert
  LOCKED    // Cours commencé, Hugo est en route
  FINISHED  // Hugo est arrivé, points distribués
}

model Bet {
  id            String   @id @default(cuid())
  userId        String
  courseId      String
  guessedTime   DateTime
  pointsEarned  Int?     @default(0)
  user          User     @relation(fields: [userId], references: [id])
  course        Course   @relation(fields: [courseId], references: [id])
  createdAt     DateTime @default(now())

  @@unique([userId, courseId])
}